<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Administração - Sistema de Ponto</title>
    <style>
        /* ... (manter o mesmo CSS do admin.html anterior) ... */
        
        /* Adicionar estilo para o select de cargos */
        select {
            background: white;
            cursor: pointer;
        }
        
        select:disabled {
            background: #f8f9fa;
            cursor: not-allowed;
        }
    </style>
</head>
<body>
    <!-- ... (manter o mesmo HTML do admin.html anterior) ... -->

    <script>
        // ... (manter o mesmo JavaScript do admin.html anterior) ... 
        
        // Carregar cargos disponíveis
        async function carregarCargos() {
            try {
                const response = await fetch('/api/admin/cargos');
                const data = await response.json();
                
                if (data.success) {
                    window.cargosDisponiveis = data.cargos;
                    atualizarSelectCargos();
                }
            } catch (error) {
                console.error('Erro ao carregar cargos:', error);
            }
        }
        
        // Atualizar select de cargos no modal
        function atualizarSelectCargos() {
            const selectCargo = document.getElementById('editUserCargo');
            if (selectCargo && window.cargosDisponiveis) {
                // Salvar valor atual
                const valorAtual = selectCargo.value;
                
                // Limpar options
                selectCargo.innerHTML = '';
                
                // Adicionar options
                window.cargosDisponiveis.forEach(cargo => {
                    const option = document.createElement('option');
                    option.value = cargo;
                    option.textContent = cargo;
                    selectCargo.appendChild(option);
                });
                
                // Restaurar valor anterior se existir
                if (valorAtual && window.cargosDisponiveis.includes(valorAtual)) {
                    selectCargo.value = valorAtual;
                }
            }
        }
        
        // Modificar a função abrirModalEditar para usar select
        function abrirModalEditar(usuarioId = null) {
            const modal = document.getElementById('modalEditar');
            const titulo = document.getElementById('modalTitulo');
            const form = document.getElementById('formEditarUsuario');
            
            // Substituir input por select para cargo
            const cargoGroup = document.querySelector('#formEditarUsuario .form-group:nth-child(3)');
            if (cargoGroup) {
                cargoGroup.innerHTML = `
                    <label for="editUserCargo">Cargo:</label>
                    <select id="editUserCargo" required>
                        <option value="">Selecione um cargo</option>
                    </select>
                `;
                atualizarSelectCargos();
            }
            
            if (usuarioId) {
                // Editar usuário existente
                titulo.textContent = 'Editar Usuário';
                const usuario = usuarios.find(u => u.id === usuarioId);
                if (usuario) {
                    document.getElementById('editUserId').value = usuario.id;
                    document.getElementById('editUserNome').value = usuario.nome;
                    document.getElementById('editUserEmail').value = usuario.email;
                    
                    // Configurar select de cargo
                    const selectCargo = document.getElementById('editUserCargo');
                    if (selectCargo && usuario.cargo) {
                        selectCargo.value = usuario.cargo;
                    }
                    
                    document.getElementById('editUserTelefone').value = usuario.telefone || '';
                    document.getElementById('editUserWhatsapp').checked = usuario.whatsapp || false;
                    document.getElementById('editUserAdmin').checked = usuario.isAdmin || false;
                }
            } else {
                // Novo usuário
                titulo.textContent = 'Novo Usuário';
                form.reset();
                document.getElementById('editUserId').value = '';
            }
            
            modal.style.display = 'block';
        }
        
        // Carregar cargos ao inicializar
        document.addEventListener('DOMContentLoaded', function() {
            // ... (código anterior) ...
            carregarCargos();
        });
    </script>
</body>
</html>